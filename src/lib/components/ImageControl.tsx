import React from 'react';
import { useControlState } from '../hooks/UseControlState';
import { ControlProps } from '../types/FormConfig';
import { getNestedValue } from '../common/functions';

export const ImageControl: React.FC<ControlProps> = ({ config, parentPath, additionalProps }) => {
    const { key, dataPath, isVisible, isDisabled, state } = useControlState(config, parentPath);
    // const base64ImageData = getNestedValue(state.data, dataPath); // Assuming this is the Base64 string
    const base64ImageData = `/9j/4AAQSkZJRgABAgAAAQABAAD/2wBDAAgGBgcGBQgHBwcJCQgKDBQNDAsLDBkSEw8UHRofHh0aHBwgJC4nICIsIxwcKDcpLDAxNDQ0Hyc5PTgyPC4zNDL/2wBDAQkJCQwLDBgNDRgyIRwhMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjL/wAARCADIAKADASIAAhEBAxEB/8QAHwAAAQUBAQEBAQEAAAAAAAAAAAECAwQFBgcICQoL/8QAtRAAAgEDAwIEAwUFBAQAAAF9AQIDAAQRBRIhMUEGE1FhByJxFDKBkaEII0KxwRVS0fAkM2JyggkKFhcYGRolJicoKSo0NTY3ODk6Q0RFRkdISUpTVFVWV1hZWmNkZWZnaGlqc3R1dnd4eXqDhIWGh4iJipKTlJWWl5iZmqKjpKWmp6ipqrKztLW2t7i5usLDxMXGx8jJytLT1NXW19jZ2uHi4+Tl5ufo6erx8vP09fb3+Pn6/8QAHwEAAwEBAQEBAQEBAQAAAAAAAAECAwQFBgcICQoL/8QAtREAAgECBAQDBAcFBAQAAQJ3AAECAxEEBSExBhJBUQdhcRMiMoEIFEKRobHBCSMzUvAVYnLRChYkNOEl8RcYGRomJygpKjU2Nzg5OkNERUZHSElKU1RVVldYWVpjZGVmZ2hpanN0dXZ3eHl6goOEhYaHiImKkpOUlZaXmJmaoqOkpaanqKmqsrO0tba3uLm6wsPExcbHyMnK0tPU1dbX2Nna4uPk5ebn6Onq8vP09fb3+Pn6/9oADAMBAAIRAxEAPwD1DH6UY70/GaNvHvTIG44pVHBpQMZHpTgMUgIthWYSbiQBgrnilPAp5FRTNgH86AIt4aLzFOVzt/Gq7OOmeKy9c16z0W2MkzgueViB+Zj/AJ715lq/jfUdQ3Ro/kQnI2R8ZHuepoKsei6l4n0zTWf7RcqXB+5H8x+nt+Nc9P8AEm2DkQ2Mjp2LSBT+WDXmctwzklmOT61AZfmpXGep2/xKt3fE9jIgx1Rw3P0wPaup0zX9P1VR9knDMRkoRhlrwMS45qeG7eJg6OysDkEHpRcLH0YknNTo/PNeQ6F8QLuCRIdQYzQcAtj5h75716Xp+p2upWontZhLEeCQOhpiaNkGg8A4qBHB4OOOf8/pUzEN0JyRg0ENCN27/wD66jPAJ46frTt1Rk4BxTERnJjGOtQlh16VI5wCRUbY9OKYjVA4pcUuOtFSaDcZPWnAcUuOKAOKAsNYZWub8R67FoWmK8jB5jlY07uff2HHNdK3T8K8M8W6q+q63PLvzEhMcWP7oPB/Hr+NIaMTV9TudSvHubmQu7fkB2FZTtVp0PXFQPGD2pDK7ZxxzSGpxASeFJNDWsq8lGA+lIZXwaXpQQwJGDSYb0NAEqvtNb3h7xBcaNfpLG5MecSR54de/wCNc7yPWpY2O4dKYj6H0+/hv7WO4tpFkiccMtaitkV5J8OtYMN5LYOx2TfOnPRh1wPp/KvV4m4poljyeajY04mo2pkEbdKiY8VI9RGmBtgUuO1LxRjpUmgYzQPT86djt3pPegChrFz9h0i7uRtzHEzDJwCccD86+f5gWfGMnNe4eNt//CKXoTGSFz9Nwz+ma8UjXdcgn1pMpIsS6RKYowi54+Y0kWjEn51x7GuigH7od+KkIUDoM1i5tG3IjHi0uOL5tvNTfZ0Iwyg/UVeLA8ZqLHvWTbbHYyJ9Nt2bdsAP0qu9lEOiCtiZeORVByAx6YpczCxiXdgCcis0xPGwDCuhnYE4FVmRTnIzW0JPqRKJFod62n6ta3IZlEcgJI9M8/pX0DAfl/WvnVsJcYHHNe+6G5fRrFySSbeMnPXO0VujGRpE1Ex5NPPTNRN940yCNjxUZqRqiamI6AA4/pQOo+tKOtLipNQxxjvQBxS4ooAyfEkfmeH79du4/Z3wAOpAOK8Ts7Zp7nCD3r1jxtLm2trXeUEzMcg+g4/nXn2mWz2t1co47Ag+1ZTn0NacNLlj5baMAsPejej/AMQNVLnT7i/kY7iqD7orLutNvrYHy7gH23YrKyfU0d10Nt4+MqajJIFc3HLqJkC+aSew3Ctm3S7eVfMGBjmpcUuold9CdwWU81Tlgyc+tW5n8pvmrB1HUH8zbGTgelJK70BuxZmhC9OlVHG09azjNfyHCByD68Uzyr0YZsgitYxt1J57ky20lzqUMCD55XCL2GScV79p8awWscSDCogUD2ArweMNIYHIwwJJ/CvZfC9wX8P2rMzO2wjJ9iR/StovoZTWlzcY5qM80hlFMMi1ZkDHvUR608kVGTQI6THNFL79qWpNhBS0jssSF3OFHU04cgEUXEc54vjQ2FvKyAmObr6Daf8AAVxKSJNcSEKB8o/LJr0XxDbvcaJcKgBZRvwe+Dk/oK82tovKnmx91gCv68Vz1V71zppP3bD7hWaPZE+01l6jp8b6cFIkN4GDbmwY2HpgYx+VazwkncKglXjBNZqXK9C5q6szm4bJILdIQu+XduLngfT6VuWcnlJggk+9KsK55AqwI0VN2MCiT5iYRsYmqyl1bAwaw7faZcugYdwTitvUQATismJV81loi7BOJXFiouVd2zCCT8pO4+xP9ajEUizHY5MeeAT0rY2J0ZRTHiQDKrir9pczUCqsYyuTjr/SvXtDAGhWOBjMCH9BXlMMDXFzbwR43SPtGfU4FexQQJb20cMYASNQqj0AGK2h3M5voOJxTCacenNMPqelaGQzcRz+lL5mTg0xj6Uxu1AjsPQ0cge9L3pcc0jYjkwYyDH5gPBXj+tSUvSjuKBDGRXUqwBBGCK8+1nQ20m9SVXDW8pZRk8g9QD+R/KvQxzmsDxdB5miNMse94HWRfbnBP8A3yTUSjdFQk4s47nacVUmj7mrSSAgEdCKbMoKZ4rkeh22ujMZm3qqDLE4FWI7W4cnefoKaoEf7zdhuoqncaw0En+tLnHTFGrITS3E1O1dBuYdDiueaErKZU6DqK0NR1r7VAWVcc4z71j293vJR2PB71STWpMpJuyNjaGQEHiqkxwMU+O5AUrmqs0mXpRWpF7HV+CtJF1em/lPyW/CLjqx/wAOPzr0Js1y/gKNk0FpD92WZmX6ABf5qa6cn8q7IqyOeTuxjHFMf7lOY5qN+mB+VUQRE0080pppoEdnilHejPHrilH3aRvYOlFB60hI/KkICBmobqCO5tpYJVDRyIUYHuCMGnvJ1qvLNhTzQFjyuVZ9OuZbWYhpIW2tjvxwR9eD+NSSTE2zOvUDpV/xosf9oR3EQBlCYlCnk+mR64/SueW6DQMu3crjqDXNOOp1QehSMzySlJZRGCerGmSWNs6tunYk9xxWhFbRMpDKCCe9E0USA7ipX3OKSaBR7nPzWkMFv5ZldkznAHNZbxwbiwZgfet+ZrNUfKoT2w1Y0jKxO0DHtVpmckuhAryIy85BqwgkubqO3iG6SRgij1JOBVeRwpDE810XghbaTVZLmZwJYxiFSepOcke4H86qKu7md9LHqOmwRWGnW9rHjbDGF4GMkDk/icn8ask1li5x36cGplueOTWtzNotE8VEx5phnDDrzSFwe9UQxXPNRtQxBFMJoEdxSjpTSaYZMcVJ02JGYCoHlxUUs4UEkgD3NctrWtXzMbfTBFHIcAzTH+S4P5n3470LUHZLU37u/gtomeaZIlHUu2AK4LxF45lVpbew2LHjHnBtzHpyMcDv69e1V72xs7OCS41zUZLmd1xGhLcHvjBz/IVwVxISoGeK2hTW7M3O+x0umvM1u0k7lpJWLkk5PNRXsEsbefbglcYZF6/UVYtsGFcdCBips1wTl71zpirIqWl7CYlGc54x1Ip08lvKCrNkehqC50pZZDNbuYZDkkfwtWXKmoQbt8W44wGBzSsnqgdwuLO3Vi2eKoTTRKMAU2WW4JO5DzVQxSSONxwPQVol3MmMZ2uJSqj5R1NTSN5cagdARUiQiNMAYqG54j981cH7ySJex1mm+MFgiihuRI4AwZCcn/E10dn4gsb07YLlCx/hPBP0B615xpWqDTzIrxeZHIAG5/z61o+b4fuGKBZoCefMGcD9T/Kt5R1M1Jnoq3mRnpUouveuOtLqGzAjGpeYh+750ikfn17euK1LS7knUsEAHZ1dWVvoQf6CotYejOhW5460/wA4GsQXBXhsg+9TJc8daEyWj0t5P/rVlahrFvZxvvkXcmc5OApxnBPPOOwBPfFY+pa9NdZt9Jia4JwGmB2xjnkbu/4c4PByK5nVNbtNJbbM/wBt1Fc7igxFCSclV989TjOevenGDe5tKaWw7XPFuqSFo7C2mEbDImeI5Ix/CvQDr1yeevYYdj/wkeozbULxhusjqEx75xn8qrv4rMkmTad/+en/ANarNtq2q6xILawh8pcjdKDyo927fhzxxVpdkZNt7mlNp+i6fxqt79pvGIL7nbIOO4Bz6da4/U1tvtcv2R90GfkOCOPTmusuvClhAyC4vn3Yyzlgg+vIOPzrJ1iLQUt3jsZ1E8fXl239uvTP04rWLVyA0W5E9oEJ+ePitHPzc1x8FxJZTiWPkdx610FvqkN0o2nDHsa87EU3CXkddOV0aO8Dg4IqGcKwPP50wyZFRPKMYxXOXczLyJcnBFUwgXJxWhIpd+FJqvLA4OMVaZJTON3FZ13IGkwOi1duZlh3Rp8z45PYVnR7DMolLeXu+Yr1x3xXZh6d/eZjUlbQ0dH1SCxR45oSVlbDOD0H0/OteOfw8oYbUIbrmNj+WelOS90S+WO1eMRoowPNUKAPYg8VMuneHgPvwfjcf/XrZtX1MigmjaZfy7rK8KgdY8ZP4Z5H61pQ2CWETLb6m1tKeiyspVvwP86rXOiaTckCzuUjkx0jk3598E5qIeFTvB+3Hb6mL/69L5iL6v4khkKvHDcr2J2gf0NW4724jUfbLSSA4yXX50H1I+7+NUo9G1WyVRY6iGUjlZFwB9Ac0i/8JSGHAYA9/LwaTSY7nUW02q65kOradpqr8xAwWXsoPH6YGPXpWNdLodvIwR4JNowS7hyff/8AVTL241fXbbBxDaIMfMcKx6892PT2+lZkHhzzpCWuunXCf/Xq3oMtw32hYbKwbhyMwHn9Ktx+J57mVLTSrcmaTCqzgcHB6Dp75Jx7VXTwvaEjdJPnGCQw6/lVxbm10iN7bR4klv5MqvlqXI9fft0/HFJWuIhu/Czo/mXOohpm+Z8LuySeeSck9ecUy18KWkmDJNcbj3GMH8MfSsYjXtRumcPdMx5+Zyv8z7VYGm+IZV2nz2X0M4I/nVa9wNTVPCccMBNk7M6DlJGBLf4GuQIktpSCrKynBU8EH+lbcXhfVZ3+4in3kB9PTPY5qO68KapApbZGx9BIB/Oq0atLUIycXdEVrquFAcFvoeatDV7PP7wun+8hrPGg6oU3i0LD2YH+RpV0LVS20WzdM4LDA/X/ADz6GuWWFg9Uzf2ye6NFtc0+P7u5z/sr/jVG61GeeB5YrYpFnbvPJNNGg6tvCLbDJOOJF/xrvvA1vBpNu41BYVuGlOZN3zBCqgbSO4+fj/a+tYVqcaUHK1/mNVI33PLLe3kvLgoGVSTyztgCumtdH0VY1WSSGVv4maUrn8jTvEGgpeavLNp7QRwsoLHBUF+rHAyOvp71mJ4Uvy3EsH13N/hXXTmpwTWhhJtt3NO80LSJ0ZLZlRxyCku49PTNVf8AhElPP244/wCufP8AOmS+ENQCE+db8f7TD+n+fzqkbTX4iVDXDqpIBWQkH9avXuQXJvCjrEXhvAZAPlBTHP1zxVUf8JDbJjfcMOmQ2/8AxpqyeIAflW/PTgqxH5Gp7fxRcWqmC6tC0q9SWKH8RijX1AdaQ+IpNrxG53Ds74/QmrBu/E0cZJWX5f8ApkpP8smkt/GQRiGsiR6CX/61PuvGaOCPsJBP/TXOP0o17AWZvFV6bQRBE83BDyH+LnqF6A/4VkRrq9/I6AzYYcgnYpH6A1219pmmLLHrOnJts54mk2lc7RznA7EMMcccYFcpc+IkikLW8DHI+85xz9KTt0LJ4/C8jRB5LsB+4RNwH45FaVtLY+E4JvNZ57q4XhhEPkX8T3Ofy6euBFNrWrFmtzOVBwBESqjvj/PtWxf6JBbxRfbriWW4VFMpeQbRx09cds5p+oilH4qTz5H+yM4J4zJj+lSt4vnAxFaxJx/F81WbOHRYolUtZY65dlJz+NaKnQUTk6cduCPlQ8Y9/wDP8qSt2EYR8XXpPEFuPT5Tx+tSTeLrwpzb2/vgMMj8/wDP5Vqb9BEmSLHCn/Y5A9ufT/Pe8R4elhyG0wHPIwoz3/z/AF6VS5ewjnLfxisQw1k3PXbNj+lTv4yQpxYkjOctNk/+g1NNDoJk5+xnHZXUfy6/5/Gylt4fMSgiw69TLz/OkuXsBzz+LJ/NJit0QY4ySeacfFt9/wA8YCD6g/41rsmiBwcWB4wSSgFSm40CFQxWwz14RWPb0H+efoF7vYLnNz+K79ukUA9gp/xqKPxPqKtlBEp9krcfW9HViEmAGeAIiP6U6PX9K4BuyP8AgLcfp9KNOwzN/wCEt1Bo9pht8dcFD7e/+c1Vi8VSxM6zWysTxlGK/wCNdPb+IdH2APdHGO6u2fzHv/nvm6jeaHfToPMhcHPLIVx+JAx+dN27CRTHi9dv/Hkc/wDXX/61OttV0q/uW+0xRRu3AMyg/r6fWpBY+GyeHty2ehucY4/3v8/yS+8O6fLah7YeW3BEisWB9eCf8/zXugWFi0BpASbLnsHUfyqHUdN0y/niitvJAXBYwFST+I6Vlv4Wm2qYbpGbPRlK/wCPvVO4tNQ0y+NjFJuklUEiHOeM8Zxn1o+YHXTX76RZL9jCNas2WjLFhn1GeRxmqsEOjy2QulSJWYHcJZQSDnpgn8u/P51rLSpLXVUivI1ktZD5chWTaADwG9cA4b3xT18PQi/a1a5MOWKksu76elPQoni1iWS3nTToJpWGAXRCQhPTjHXg+nSsj7BquqOPtEsmM8ee5Jz9DW3Hc2fhezns3M0lxKxZmRQFIxgDrn19awX128nuT9lTyyegA3N/L+lHlYPQ0o/CkzMALgdcH5en61aHg5+M3eTjkLHnH6/5/llf27qyJh5dqnJyYlH9KB4k1ReBcjnp+7T/AAqveEaR8ISBvmusen7vv+f+fyzO3gu62ExXcJA/56Ap+WM5rFbxBqhwftHfP+qTn9KtWfivVoJMtIso/uSRjH14xTXPcQy78J30b48+2P0Y4/l/n86IvCl6zgefbgHvljj8hT7vxbfSDDQW/H+y3+NUD4o1F2+XylHoEyP1z/k0nz3GXJfCV8RnzYT+LDH5j/P05qZPB8xT5ruMe4Un/P8An6VXPivUvLCqsK8dVjqtJ4k1VhxMB9Il/wAPp+Q9BR74i5L4RAPF9uGM58vH9aRPCI2MTdEkDI+TH9azG17VM7jPz0z5a/4U1bvWbphte6fPTywcYzjt70veA3Y/CUROFu3A/vNH/wDX+n5im3Pgo+TuF7n/ALZjr/31WQ0mvDO5tR556v8A57/rVqXWdftIEjnknTIO3zY+T68kZPb9KdpdxFQeGrx8ATQYzjJJ4/Sh/Dd+i5UxOw7K3NVW1zVA7Ym6nJPlqcfpxSpruru48qRmI/uxj+gqfeGOOpa1p0qxzMw24+V1BBH171dtfES/bJLm9QtIQAiooxjHv/8AX61KviaJW/0u3ljlxtdVXv8AiaY93pmq6ihnKhEiP+sOzn86XqgC9128ZiCkQ+in/Gs9hdzxLch2EWSpO/gH0/X9aKKctNizsZ9N06fTbS8uHaV3hVpZZJsgtjnnPbp+H1rOGsabpsvlwjcvpCAcfjmiilu9RGja+LNPAbMdz04OB/jUyeJtLdsO0i8fxJwP5+v+ehKKtQQiZvEmk7Di7APoY3z/AC/zxTF8R6WsnN6uOnEb8j8v8/gMFFHKFgu7jQLmJpI2smY8ndGEOfxH+P8AjkprWlW7lEmVQD0VDg9PQYooqWtRF2HxHpjKD9qKkfwlGHp6f5/mUk8R6YjALeZH/XNv8KKKfKgI38Q6UicT7jjosbf/AFvT/PasfFGnK2Ns7Y6YUY/nmiijkQDZPFliWYeXNt7EKMn361btPFumvtRhPH/tsM4/EHP+e3WiinyIGijqPiDTFU7JDKCeFVDx+YFY03iSH5dkMjEf3iBRRU8qGloWVuNM1xFWcGG4HQ7gMj0B6H8RVSa002xuQ7TM3lkHZkEmiijyEf/Z`;
    const { altText = '', hideLabel = false, mimeType = 'image/jpeg' } = additionalProps; // Default to JPEG format

    if (!isVisible || !base64ImageData) return null;

    // Construct a Base64 data URL
    const imageSrc = `data:${mimeType};base64,${base64ImageData}`;

    return (
        <div style={{ textAlign: 'center' }}>
            {!hideLabel && <label htmlFor={dataPath}>{config.label}</label>}
            <img
                id={dataPath}
                src={imageSrc}
                alt={altText || 'Image'}
                style={{
                    maxWidth: '100%',
                    maxHeight: '300px',
                    display: 'block',
                    margin: '10px auto',
                    opacity: isDisabled ? 0.5 : 1,
                }}
            />
        </div>
    );
};
